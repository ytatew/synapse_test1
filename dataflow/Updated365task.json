{
	"name": "Updated365task",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "d365potask",
						"type": "DatasetReference"
					},
					"name": "ProjectTask"
				}
			],
			"sinks": [
				{
					"linkedService": {
						"referenceName": "d365_po_poc",
						"type": "LinkedServiceReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "taskupdate"
				}
			],
			"scriptLines": [
				"source(output(",
				"          {Task Name} as string,",
				"          {External ID} as short",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> ProjectTask",
				"ProjectTask alterRow(upsertIf(true())) ~> taskupdate",
				"taskupdate sink(allowSchemaDrift: true,",
				"     validateSchema: true,",
				"     input(",
				"          msdyn_actualmaterialcost as decimal(38,4),",
				"          msdyn_actualmaterialcost_base as decimal(38,4),",
				"          msdyn_actualsales as decimal(38,4),",
				"          owninguser as string,",
				"          importsequencenumber as integer,",
				"          msdyn_actualmaterialsales_base as decimal(38,4),",
				"          msdyn_description as string,",
				"          msdyn_actualend as timestamp,",
				"          msdyn_varianceofcost_base as decimal(38,2),",
				"          msdyn_outlinelevel as integer,",
				"          msdyn_actualfeesales_base as decimal(38,4),",
				"          msdyn_descriptionplaintext as string,",
				"          msdyn_salesvariance as decimal(38,2),",
				"          msdyn_effortremaining as decimal(38,2),",
				"          msdyn_plannedmaterialsales_base as decimal(38,4),",
				"          msdyn_projectsprintname as string,",
				"          owneridtype as string,",
				"          msdyn_totalplannedcost_base as decimal(38,4),",
				"          msdyn_plannedmaterialcost as decimal(38,4),",
				"          msdyn_costatcompleteestimate_base as decimal(38,2),",
				"          createdbyname as string,",
				"          msdyn_remainingsales as decimal(38,4),",
				"          msdyn_resourcecategorypricingdimensionname as string,",
				"          msdyn_actualexpensesales_base as decimal(38,4),",
				"          owneridname as string,",
				"          msdyn_salesvariance_base as decimal(38,2),",
				"          msdyn_actualsales_base as decimal(38,4),",
				"          msdyn_actualcost_base as decimal(38,4),",
				"          statuscode as integer,",
				"          msdyn_actualstart as timestamp,",
				"          createdonbehalfbyname as string,",
				"          msdyn_pfwmodifiedbyyominame as string,",
				"          msdyn_iscritical as boolean,",
				"          owningteam as string,",
				"          msdyn_plannedsales as decimal(38,4),",
				"          msdyn_plannedmaterialsales as decimal(38,4),",
				"          msdyn_totalplannedcost as decimal(38,4),",
				"          msdyn_plannedexpensecost_base as decimal(38,4),",
				"          msdyn_actualmaterialsales as decimal(38,4),",
				"          msdyn_duration as double,",
				"          msdyn_plannedsales_base as decimal(38,4),",
				"          modifiedbyname as string,",
				"          msdyn_plannedmaterialcost_base as decimal(38,4),",
				"          msdyn_pfwcreatedby as string,",
				"          statecodename as string,",
				"          msdyn_pfwmodifiedby as string,",
				"          msdyn_remainingcost as decimal(38,4),",
				"          msdyn_skipupdateestimatelinename as string,",
				"          modifiedonbehalfby as string,",
				"          versionnumber as long,",
				"          msdyn_subject as string,",
				"          msdyn_displaysequence as decimal(38,9),",
				"          msdyn_requestedhours as double,",
				"          msdyn_ismanual as boolean,",
				"          msdyn_msprojectclientid as string,",
				"          msdyn_plannedexpensecost as decimal(38,4),",
				"          owningbusinessunit as string,",
				"          createdon as timestamp,",
				"          msdyn_projectbucket as string,",
				"          msdyn_effortcompleted as decimal(38,2),",
				"          msdyn_resourceorganizationalunitid as string,",
				"          msdyn_transactioncategory as string,",
				"          modifiedonbehalfbyname as string,",
				"          msdyn_actualmilestonesales_base as decimal(38,4),",
				"          msdyn_parenttaskname as string,",
				"          createdonbehalfby as string,",
				"          msdyn_actualfeesales as decimal(38,4),",
				"          msdyn_totalactualcost as decimal(38,4),",
				"          msdyn_summary as boolean,",
				"          msdyn_finish as timestamp,",
				"          msdyn_actualexpensecost as decimal(38,4),",
				"          ownerid as string,",
				"          msdyn_actualexpensesales as decimal(38,4),",
				"          utcconversiontimezonecode as integer,",
				"          exchangerate as decimal(38,10),",
				"          msdyn_remainingsales_base as decimal(38,4),",
				"          createdonbehalfbyyominame as string,",
				"          msdyn_actualmilestonesales as decimal(38,4),",
				"          msdyn_progress as decimal(38,2),",
				"          msdyn_project as string,",
				"          msdyn_remainingcost_base as decimal(38,4),",
				"          msdyn_effort as double,",
				"          msdyn_scheduledstart as timestamp,",
				"          msdyn_costconsumptionpercentage as decimal(38,2),",
				"          msdyn_salesestimateatcomplete as decimal(38,2),",
				"          msdyn_priority as integer,",
				"          msdyn_totalactualsales_base as decimal(38,4),",
				"          msdyn_pfwmodifiedbyname as string,",
				"          msdyn_costatcompleteestimate as decimal(38,2),",
				"          processid as string,",
				"          msdyn_totalactualsales as decimal(38,4),",
				"          msdyn_plannedexpensesales as decimal(38,4),",
				"          transactioncurrencyid as string,",
				"          msdyn_organizationalunitpricingdimension as string,",
				"          statuscodename as string,",
				"          msdyn_salesconsumptionpercentage as decimal(38,2),",
				"          msdyn_ismilestonename as string,",
				"          statecode as integer,",
				"          owneridyominame as string,",
				"          msdyn_plannedcost as decimal(38,4),",
				"          msdyn_summaryname as string,",
				"          msdyn_pfwcreatedbyname as string,",
				"          createdbyyominame as string,",
				"          msdyn_totalplannedsales_base as decimal(38,4),",
				"          transactioncurrencyidname as string,",
				"          owningbusinessunitname as string,",
				"          msdyn_schedulevariance as double,",
				"          msdyn_plannedcost_base as decimal(38,4),",
				"          msdyn_organizationalunitpricingdimensionname as string,",
				"          modifiedby as string,",
				"          msdyn_linkstatusname as string,",
				"          msdyn_effortestimateatcomplete as double,",
				"          msdyn_resourceorganizationalunitidname as string,",
				"          modifiedon as timestamp,",
				"          msdyn_plannedexpensesales_base as decimal(38,4),",
				"          msdyn_actualcost as decimal(38,4),",
				"          modifiedbyyominame as string,",
				"          stageid as string,",
				"          modifiedonbehalfbyyominame as string,",
				"          msdyn_LinkStatus as integer,",
				"          msdyn_iscriticalname as string,",
				"          msdyn_ismanualname as string,",
				"          msdyn_start as timestamp,",
				"          msdyn_totalactualcost_base as decimal(38,4),",
				"          msdyn_skipupdateestimateline as boolean,",
				"          msdyn_resourcecategory as string,",
				"          msdyn_projectname as string,",
				"          msdyn_projecttaskid as string,",
				"          msdyn_pluginprocessingdata as integer,",
				"          cr3c6_externaltaskid as integer,",
				"          msdyn_actualexpensecost_base as decimal(38,4),",
				"          msdyn_scheduleddurationminutes as integer,",
				"          msdyn_ismilestone as boolean,",
				"          msdyn_pfwcreatedbyyominame as string,",
				"          msdyn_salesestimateatcomplete_base as decimal(38,2),",
				"          createdby as string,",
				"          traversedpath as string,",
				"          msdyn_parenttask as string,",
				"          msdyn_transactioncategoryname as string,",
				"          msdyn_totalplannedsales as decimal(38,4),",
				"          overriddencreatedon as timestamp,",
				"          msdyn_varianceofcost as decimal(38,2),",
				"          msdyn_resourcecategorypricingdimension as string,",
				"          msdyn_resourcecategoryname as string,",
				"          timezoneruleversionnumber as integer,",
				"          msdyn_projectbucketname as string,",
				"          msdyn_projectsprint as string,",
				"          msdyn_scheduledend as timestamp,",
				"          {owninguser@aadobjectid@azureactivedirectoryobjectid} as string,",
				"          {owningteam@aadobjectid_membershiptype@azureactivedirectoryobjectid} as string,",
				"          {owningteam@aadobjectid_membershiptype@membershiptype} as integer,",
				"          {msdyn_pfwcreatedby@aadobjectid@azureactivedirectoryobjectid} as string,",
				"          {msdyn_pfwmodifiedby@aadobjectid@azureactivedirectoryobjectid} as string,",
				"          {modifiedonbehalfby@aadobjectid@azureactivedirectoryobjectid} as string,",
				"          {createdonbehalfby@aadobjectid@azureactivedirectoryobjectid} as string,",
				"          {modifiedby@aadobjectid@azureactivedirectoryobjectid} as string,",
				"          {createdby@aadobjectid@azureactivedirectoryobjectid} as string,",
				"          {msdyn_parenttask@cr3c6_externlid@cr3c6_externaltaskid} as integer",
				"     ),",
				"     store: 'dynamics',",
				"     format: 'dynamicsformat',",
				"     entity: 'msdyn_projecttask',",
				"     timeout: 30,",
				"     deletable: false,",
				"     insertable: false,",
				"     updateable: false,",
				"     upsertable: true,",
				"     alternateKeyName: 'cr3c6_externlid',",
				"     mapColumn(",
				"          msdyn_subject = {Task Name},",
				"          cr3c6_externaltaskid = {External ID}",
				"     )) ~> sink1"
			]
		}
	}
}